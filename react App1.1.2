import { useState, useEffect } from 'react'
import './App.css'
import react from "@vitejs/plugin-react-swc"
import {BrowserRouter, Link, Route} from 'React-Router-dom'


function App() {

  const [title, setTitle] = useState('서울시');
  const [youtube, setYoutube] = useState([
    {id:1, youtubeName : "겨울서점", url:"https://www.youtube.com/@winterbooks/videos", img:"https://i.ytimg.com/vi/X_W7dZXeqQA/maxresdefault.jpg"},
    {id:2, youtubeName : "공백의 책단장", url:"https://www.youtube.com/@gongbaeksbookdressup3399/videos", img:"https://i.ytimg.com/vi/Mdp1aAeimmA/maxresdefault.jpg"},
    {id:3, youtubeName : "따듯한 목소리 현준", url:"https://www.youtube.com/@voice_hyunjun/videos", img :"data:image/jpeg;base64,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"},
    {id:4, youtubueName: "서메리 작가", url:"https://www.youtube.com/@MerrySeo", img:"https://i.ytimg.com/vi/eB_632A8rBg/maxresdefault.jpg"}
  ]);
  const [searchKeyword, setSearchKeyword] = useState("");
  const [formResult, setFormResult] = useState("");
  const [showButton, setShowButton] = useState(false);
  const [scrollY, setScrollY] = useState(0);
  const [count, setCount] = useState(0);
  const [newLibrary, setNewLibrary] = useState([]);
  const library =[
    {id : 1, value : 11010 , libName : "종로구" },
    {id : 2, value : 11020, libName : "중구" },
    {id : 3, value : 11030, libName : "용산구" },
    {id : 4, value : 11040, libName : "성동구" },
    {id : 5, value : 11050, libName : "광진구" },
    {id : 6, value : 11060, libName : "동대문구" },
    {id : 7, value : 11070, libName : "중랑구" },
    {id : 8, value : 11080, libName : "성북구" },
    {id : 9, value : 11090, libName : "강북구" },
    {id : 10, value : 11100, libName : "도봉구" },
    {id : 11, value : 11110, libName : "노원구" },
    {id : 12, value : 11120, libName : "은평구" },
    {id : 13, value : 11130, libName : "서대문구" },
    {id : 14, value : 11140, libName : "마포구" },
    {id : 15, value : 11150, libName : "양천구" },
    {id : 16, value : 11160, libName : "강서구" },
    {id : 17, value : 11170, libName : "구로구" },
    {id : 18, value : 11180, libName : "금천구" },
    {id : 19, value : 11190, libName : "영등포구" },
    {id : 20, value : 11200, libName : "동작구" },
    {id : 21, value : 11210, libName : "관악구" },
    {id : 22, value : 11220, libName : "서초구" },
    {id : 23, value : 11230, libName : "강남구" },
    {id : 24, value : 11240, libName : "송파구" },
    {id : 25, value : 11250, libName : "강동구" },
  ]

// 슬라이더
// https://www.youtube.com/watch?v=iyj3TZXg2gQ


  //https://velog.io/@jahommer/React-Top%EB%B2%84%ED%8A%BC-scroll-to-top%EB%A7%8C%EB%93%A4%EA%B8%B0

//input 정보 변경 및 저장하기
  const handleChangeInput = (e)=>{
    const inputKeyValue = e.target.value;
    setSearchKeyword(inputKeyValue);
  };

// form 으로 검색 값 submit 하기 
  const handleResult = (e)=>{
    e.preventDefault();
    setFormResult(searchKeyword);
    searchLibDatas(searchKeyword);
  };

// Library API 정보  fetch로 data 가져오기 
  const searchLibDatas = (keyword)=>{
    for ( var i= 0 ; i < library.length; i++){
      if(keyword == library[i].libName){
        setTitle(library[i].libName)
        const selectedLib = library[i].value
        const url = `http://data4library.kr/api/loanItemSrchByLib?authKey=43d7efdc5d7f99a3be907ecac62d3212026fb810e793f19e56fb0b5a390c93f8&dtl_region=${selectedLib}&startDt=2023-01-01&endDt=2023-12-31&format=json`
        fetch(url).then((response)=>{
          if(response.status !== 200){
            console.log("서버 통신 실패!");
          } else {
            return response.json();
          }
        }).then((data) => {
          console.log(data)
          const jsonData = data.response.docs
          setNewLibrary(jsonData);
          console.log(jsonData);
        })
      }
    }
    };

// scroll Top button 
    const handleScroll = () =>{
      window.scroll({top:0, behavior:'smooth'});
    }

  return (
    <>
      <BrowserRouter>
      <div className="search-background">
        <h1><span className="lib-title">{title}</span> 우리 동네 도서관 <br/>대출 베스트 200</h1>
        <div className="search-wrap">
          <div><span className='logo'>LOGO</span></div>
          <form onSubmit={handleResult}>
            <input value={searchKeyword} onChange={handleChangeInput}></input>
          </form>
          <button type="submit">검색</button>
        </div>
      </div>
      <div className="youtube-wrap">
        <h2>북튜버를 통해 간접경험하기</h2>  
        <div className="youtube">
        {youtube.map((tube)=>{
          return(
            <div className="each" key={tube.id}>
              <div className="youtube-img"><img src={tube.img} alt={tube.youtubeName}/></div>
              <div className="each youtube-frame">{tube.id}</div>
              <div className="each youtube-name">{tube. youtubeName}</div>
            </div>
          )
            })
        }
        </div>
      </div>


      <div className="data-wrap">
      {
        newLibrary.map((item) => {
          const dataBook=item.doc;
          return (
            <div className="book-wrap" key={dataBook.no}>
              <img src={dataBook.bookImageURL} alt={dataBook.bookname} />
              <div className="detail">
                <div className="name-ranking"><Link to="/detail">{dataBook.no}. {dataBook.bookname}</Link></div>
                <div className="author">{dataBook.authors}</div>
                <div className="genres">{dataBook.class_nm}</div>
                <div className="isbn13">{dataBook.isbn13}</div>
              </div>
          </div>
        )
        })
      }
      </div>
      <div>
        {/* <Route  path='"/detail' Component={detail} /> */}
      </div>
      <button className="top-scroll-btn" onClick={handleScroll} type="button" >TOP</button>

      <div className="card">
        <button onClick={() => setCount((count) => count + 1)}>
          count is {count}
        </button>
        <p>
          Edit <code>src/App.tsx</code> and save to test HMR
        </p>
      </div>
    </BrowserRouter>
    </>
  )
}

export default App
